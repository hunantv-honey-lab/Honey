/*
 * 这是一个热的不得了的日子
 * honey, just a loader, based headjs ( headjs.com )
 * version 2.0
 * 
 * mod 约定 *dir_modname*
 *  mod_dialog    mod/dialog.js ( mod/dialog.source.js )
 *  lib_jquery    lib/jquery.js ( mod/jquery.source.js )
 *
 * 文件被多次 honey.go 的处理 OK
 * IE等不能按顺序并行下载的浏览器 OK
 * IE等浏览器下combo合并 OK
 * 合并应该限制合成后文件大小 (  )
 */var PROJECT="revive",VERSION="2011080301",DEV=!0,COMBO=!0,COMBOURL="http://lab.local:8888/",ROOT="http://beta.hunantv.com:9000/js/";(function(a,b){function y(a){return Object.prototype.toString.call(a)=="[object Function]"}function x(b,c){var d=a.createElement("script");d.type="text/"+(b.type||"javascript"),d.src=b.src||b,d.async=!1,d.onreadystatechange=d.onload=function(){var a=d.readyState;!c.done&&(!a||/loaded|complete/.test(a))&&(c.done=!0,c())},(a.body||head).appendChild(d)}function w(a){a.state=k,p(a.onpreload,function(a){a.call()})}function v(a){a.state===undefined&&(a.state=l,a.onpreload=[],x({src:a.src,type:"cache"},function(){w(a)}))}function u(){for(var a in c)if(n!=c[a].state)return a;return!1}function t(a,b){if(a.state==n)return b&&b();if(a.state==m)return j.ready(a.name,b);if(a.state==l)return a.onpreload.push(function(){t(a,b)});a.state=m,x(a.src,function(){a.state=n,b&&b(),p(h[a.name],function(a){r(a)}),q()&&e&&p(h.ALL,function(a){r(a)})})}function s(a,b,d){var e=a||f,g=!1,i=[],o=[],q=COMBOURL+PROJECT+"/"+VERSION+"/?";for(var t in e)e[t].state!=n&&e[t].state!=m&&e[t].state!=l&&(i.push(t),o.push(e[t].src),e[t].state=!d&&m);q+=o.join("&"),i=i.join(","),d?c[i]?c[i].state==k&&s(c[i].els,c[i].fn):(c[i]={state:l,fn:b,els:a},x({src:q,type:"cache"},function(){c[i].state=k,j.go(i,function(){b&&b.call()})})):(c[i]={state:m},x(q,function(){c[i].state=n,b&&b();for(var a in e)e[a].state=n,p(h[e[a].name],function(a){r(a)})}));return j}function r(a){a._done||(a(),a._done=1)}function q(a){a=a||f;var b;for(var c in a)b=!a.hasOwnProperty(c)||a[c].state==n;return b}function p(a,b){if(!!a){typeof a=="object"&&(a=[].slice.call(a));for(var c=0;c<a.length;c++)b.call(a,a[c],c)}}function o(a,b){var c=j.trim(a);if(f[c])return f[c];var d=c.split("_"),e=(COMBO?"":ROOT)+d[0]+"/"+d[1]+(DEV?".source":"")+".js",g={name:c,src:e};b||(f[c]=g);return g}var c=[],d,e,f={},g=[],h={},f={},i=a.createElement("script").async===!0||"MozAppearance"in a.documentElement.style||window.opera,j=window.honey=window.HN=window.HN||function(){},k=1,l=2,m=3,n=4;j.go=i?function(a,c){var d={},e=c===b?!1:c,f=a.split(",");p(f,function(a,b){a=o(a),d[a.name]=a,COMBO?COMBO&&b==f.length-1&&s(d,e):t(a,e&&b==f.length-1?function(){q(d)&&r(e)}:null)});return j}:function(a,c){var e={},f=c===b?!1:c,h=a.split(",");if(!d){g.push(function(){j.go.call(null,a,c)});return j}if(COMBO){u()?p(h,function(a,b){a=o(a,!0),e[a.name]=a,b==h.length-1&&s(e,f,!0)}):p(h,function(a,b){a=o(a),e[a.name]=a,b==h.length-1&&s(e,f)});return j}var i=h.shift();h.length?(p(h,function(a){v(o(a))}),t(o(i),function(){j.go.call(null,h.join(","),f)})):t(o(i),f);return j},j.ready=function(b,c){if(b==a){e?r(c):domWaiters.push(c);return j}y(b)&&(c=b,b="ALL");if(typeof b!="string"||!y(c))return j;var d=f[b];if(d&&d.state==n||b=="ALL"&&q()&&e){r(c);return j}var g=h[b];g?g.push(c):g=h[b]=[c];return j},j.trim=function(a){return a.replace(/^\s+|\s+$/g,"")},setTimeout(function(){d=!0,p(g,function(a){a()})},300),j.debug=function(a){if(!!DEV)if(window.console&&console.log)console.log(a);else{var b=document.createElement("p"),c=document.getElementById("honey-debug-close")?document.getElementById("honey-debug-close"):document.createElement("input"),d=document.getElementById("honey-debug")?document.getElementById("honey-debug"):document.createElement("div");document.getElementById("honey-debug")||(d.style.fontSize="12px",d.style.color="#fff",d.style.backgroundColor="gray",d.style.position="absolute",d.style.width="300px",d.style.right="0",d.style.top="0",d.id="honey-debug",document.body.appendChild(d),c.value="close",c.type="button",c.onclick=function(){d.style.display="none",isDev=!0;return!1},d.appendChild(c)),b.innerHTML=a,d.appendChild(b),d.scrollTop=d.scrollHeight}}})(document)